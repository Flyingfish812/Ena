# POD+NN 多尺度预测性能研究：实验指导手册（整合版 v2.0-draft）

> 本文件为 **instructions.md（v1.1）** 与 **instructions-2.md（v1.2）** 的**完整整合版本**，并吸收了近期关于
> *尺度可恢复性*、*自适应裁切* 与 *Fourier 评估失效性* 的系统讨论结果。
>
> 本手册的目标是：
> **一次训练，完整存档预测结果；多次离线评估，探索并验证“尺度可恢复性”的正确度量工具。**

---

## 一、研究目标与问题澄清（v2.0 统一口径）

### 1.1 原始研究动机

本研究旨在系统评估 **POD 基展开 + 神经网络预测** 在二维物理场重建任务中的多尺度表现，核心关注：

* 模型在不同尺度上的预测能力是否存在上限；
* 该上限是否随采样率 $p$ 与噪声强度 $\sigma$ 发生系统性变化；
* 神经网络是否相较线性基线在“可预测尺度”上存在结构性优势。

### 1.2 关键澄清：本研究**不再**试图回答的问题

经过系统实验与否证分析，本研究明确 **不再试图回答** 以下问题：

> “是否存在一个由 NRMSE 阈值定义的、唯一的最小可恢复尺度 $k^*$？”

原因在于：

* **local NRMSE(k)** 在高频区间呈现连续、非单调退化，缺乏相变结构；
* **cumulative NRMSE** 被低频大尺度能量主导，其平台行为不对应信息丧失；
* 上述指标在数学上无法区分“结构性预测失败”与“能量占比过小”。

这些结论构成 **negative result**，并被正式记录为方法论边界。

### 1.3 v2.0 阶段的核心科学问题（统一版本）

本阶段研究转而回答以下问题：

> **在逐步引入更小空间尺度（更高波数）的过程中，模型预测结果在何种尺度以下不再携带与真实物理场可区分的结构信息？**

该问题强调：

* *信息一致性*（structure / coherence），而非误差幅值；
* *尺度区间或条带*，而非单一 cutoff 点；
* *离线评估可反复迭代*，而非与训练流程强耦合。

---

## 二、数学基础与符号体系（继承 v1.1 + v1.2）

### 2.1 POD 表达

设物理场样本为
[
x(t) \in \mathbb{R}^D, \quad D=H\times W\times C.
]

标准 POD 分解：
[
x(t) \approx \mu + \sum_{k=1}^{r} a_k(t) q_k,
]

其中 $r=128$。

### 2.2 POD 模态分组（v1.1）

[
\mathcal{S}_i = {16(i-1)+1,\dots,16i},\quad i=1,\dots,8.
]

对应模态场：
[
m_i(t)=\sum_{k\in\mathcal{S}_i} a_k(t) q_k.
]

### 2.3 物理尺度（Fourier-based, v1.2 继承）

二维 FFT：
[
\hat u(k_x,k_y)=\mathcal{F}{u(x,y)},\quad k=\sqrt{k_x^2+k_y^2}.
]

径向波数 binning 后得到 $k_m$。

---

## 三、被否证的尺度判据（必须记录）

### 3.1 Local Fourier NRMSE(k)

[
\mathrm{NRMSE}_F(k_m)=\sqrt{\frac{E_e(k_m)}{E_x(k_m)}}.
]

**结论**：

* 在高频区间连续退化；
* 无单调性或相变；
* 无法定义稳定的噪声起点。

### 3.2 累计低通 NRMSE

[
\mathrm{NRMSE}*{\le K}=\sqrt{\frac{\sum*{k_m\le K}E_e(k_m)}{\sum_{k_m\le K}E_x(k_m)}}.
]

**结论**：

* 平台由低频能量主导；
* 不对应预测信息丧失；
* 仅作为整体误差诊断量保留。

---

## 四、v2.0 核心评估工具（正式采用）

### 4.1 尺度相关系数（主指标）

对每个尺度 bin：
[
\rho(k_m)=\frac{\langle \hat U(k_m),U(k_m)\rangle}{|\hat U(k_m)|,|U(k_m)|}.
]

物理意义：

* $\rho\approx1$：结构一致；
* $\rho\approx0$：与噪声不可区分；
* $\rho<0$：系统性反相。

### 4.2 可恢复尺度条带（Adaptive Recoverable Band）

定义：

> 连续区间 $[k_a,k_b]$，其中 $|\rho(k)|$ 高于噪声置信区间；其外侧为结构性不可恢复区。

不再强制定义单点 $k^*$。

### 4.3 能量比辅助指标

[
R(k)=\frac{E_{\hat U}(k)}{E_U(k)}.
]

用于区分“预测错误”与“未预测输出”。

---

## 五、实验模块设计（统一 v2.0）

### 5.1 训练阶段（一次性）

* 仅负责：

  * 生成预测场 $U_{\text{pred}}$；
  * 存储 POD 系数、Fourier 系数；
* **不在训练阶段计算任何评估图像或 cutoff。**

### 5.2 评估阶段（离线、可重复）

* 从存档数据中计算：

  * POD 指标；
  * Fourier 指标；
  * 相关性指标；
* 快速迭代不同尺度定义与判据。

---

## 六、需存档的数据结构（v2.0 关键）

每个实验配置 $(p,\sigma,\text{model})$ 至少存储：

* 原始预测场 $U_{\text{pred}}(t,x,y)$；
* 真实场 $U_{\text{true}}$；
* POD 系数 $a_k(t)$、$a_k^*(t)$；
* Fourier 系数 $\hat U(k_x,k_y)$、$\hat U^*(k_x,k_y)$；
* 能量谱 $E(k)$。

评估指标 **不得反向写入训练结果**。

---

## 七、输出结果的科研定位

v2.0 阶段的成果形式为：

* 尺度相关性曲线 $\rho(k)$；
* 可恢复尺度条带随 $(p,\sigma)$ 的变化；
* POD 模态尺度与物理尺度的一致性/不一致性分析；
* 明确指出 **不存在 sharp cutoff 的情形**（negative result）。

---

## 八、结语

本手册完成了从“误差阈值驱动的尺度判定”向“结构与信息一致性驱动的尺度分析”的正式转向，
并为 v2.0 架构下的 **训练–评估解耦** 提供完整实验与数学依据。

该版本即为后续所有实验与论文撰写的唯一参考文档。
